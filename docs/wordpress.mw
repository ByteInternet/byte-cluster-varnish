= Snelle instructies =

# Download [https://github.com/ByteInternet/byte-cluster-varnish deze plugin] naar je eigen computer.<br />
# Log in op de admin panel van je Wordpress site<br />
# Ga naar Plugins &gt; Nieuwe Plugin &gt; Upload Plugin &gt; Upload de zip file &gt; Klik op &quot;Activeer&quot;<br />
# Klaar! Controleer of alles goed werkt. Bij problemen, lees verder.

= Achtergrond =

Byte heeft in samenwerking met 42functions hiervoor een eigen plugin<br />ontwikkeld. Deze plugin haakt in op de diverse processen binnen<br />WordPress en zorgt ervoor dat de cache op de correcte momenten geleegd<br />wordt. Denk hierbij aan het wijzigen van berichten, categorieën, widgets<br />of andere elementen op de website.

Indien de plugin correct geactiveerd is zie je een extra menu<br />verschijnen in de admin bar. Dit menu, ‘Cache’, kan gebruikt worden om<br />de plugin aan te sturen of om te configureren.

== Plugin configureren ==

Na het activeren van de plugin is deze gelijk actief. Er wordt een<br />standaard configuratie ingeladen welke van toepassing is voor de meeste<br />websites. Uiteraard is geen website hetzelfde en het is dan ook aan te<br />raden om de configuratie na te lopen nadat de plugin geactiveerd is.

Je kan de configuratiepagina vinden onder het menu item ‘Cache’ &gt;<br />‘Configuration’ in de admin bar. Eenmaal op de configuratiepagina<br />aangekomen kan je aangeven welk gedrag de plugin dient te vertonen<br />rondom het monitoren van opties, berichten, terms en comments.

=== General ===

In deze sectie kan je de efficiëntie van de plugin instellen. In sommige<br />gevallen wil het wel eens voorkomen dat er een pagina gewijzigd wordt<br />welke en grote hoeveelheid onderliggende pagina’s heeft die geleegd<br />dienen te worden; denk hierbij aan een archiefpagina. In sommige<br />gevallen wordt het legen een grote hoeveelheid pagina's inefficiënt. Het<br />is mogelijk een maximum in te stellen, indien dit maximum overschreden<br />wordt leegt de plugin automatisch de hele cache.

Aanvullend hierop zijn veel van de pagina’s die gemonitord worden door<br />de plugin gelaagde pagina’s. Dit zijn pagina's met eigen navigatie, zoals categorie of blog overzichten.<br />Omdat het in grote installaties kan oplopen tot een<br />flink aantal pagina’s kan er daarom een limiet worden ingesteld waarbij<br />bijvoorbeeld enkel de cache van de eerste 10 pagina’s geleegd wordt.

Verder is er het mogelijk om extra opties binnen WordPress te monitoren. Bij veranderde instellingen wordt de cache<br />automatisch geleegd.  De plugin kijkt uit zichzelf al vele opties, zoals de permalink structuur, tijdzones en SEO<br />instellingen.

Indien je een nieuwe plugin heb geïnstalleerd die invloed heeft op de<br />uitstraling van de website of op de onderliggende technieken (denk<br />hierbij aan SEO). Dan is het bijvoorbeeld ook handig dat de cache<br />geleegd wordt na het wijzigen van een optie in deze plugin. Dat kan dus<br />middels deze extra monitoring optie.

=== Posts ===

Berichten zijn de belangrijkste entiteiten op je website. De berichten<br />geven je website immers de vorm en inhoud waar je bezoekers naar op zoek<br />zijn, deze definiëren je site structuur en bepalen de vindbaarheid van<br />je website. Het is dan ook belangrijk dat de juiste cache geleegd wordt<br />na het wijzigen van een bericht.

Middels deze plugin kan je aangeven welke pagina’s, archieven en feeds<br />binnen jouw website relevant zijn om te legen na het wijzigen van een<br />pagina.

Onderstaand een afbeelding van alle relaties die een pagina binnen<br />WordPress kan hebben. Bij het wijzigen van een pagina is het dan ook<br />belangrijk dat deze allemaal gecontroleerd worden en geleegd worden<br />indien deze van toepassing zijn.

=== Terms ===

&quot;Terms&quot; is de omvattende benaming binnen WordPress welke gebruikt word<br />voor categorieën, tags en taxonomieën (eigen categorieën). Deze pagina’s<br />dienen doorgaans als een verzamelarchief voor alle onderliggende<br />berichten; het is dan ook belangrijk om te definiëren welke pagina’s er<br />geleegd moeten worden na een wijziging omtrent terms.

Voor de terms kan je via de plugin aangeven welke feeds, archieven en<br />pagina’s geleegd dienen te worden na het wijzigen van een term.<br />Aanvullend hierop kan nog aangegeven worden welke feed types de plugin<br />allemaal dient te legen.

Onderstaand een afbeelding van alle relaties die een term binnen<br />WordPress kan hebben. Bij het wijzigen van een erm is het dan ook<br />belangrijk dat deze allemaal gecontroleerd worden en geleegd worden<br />indien deze van toepassing zijn.

=== Comments ===

WordPress kent verschillende soorten comments. Het is niet voor alle comments nodig, om de cache te legen.<br />Hier kan worden ingesteld bij welke comments dit wel moet gebeuren.

Na het wijzigen van een comment waarvan het type is gemarkeerd in de<br />plugin wordt automatisch de cache van de gekoppelde post geleegd.

= Gebruik je W3 Total Cache? =

W3 Total Cache is een van de meest gebruikte plugins als het gaat om de<br />verbetering van de performance op WordPress websites. Deze rijk gevulde<br />plugin heeft een scala aan configuratiemogelijkheden waarbij diverse<br />caching methodieken op een  website kunnen worden toegepast. Eén van de<br />opties die zij hierbij bied is het gebruik van Varnish.

Hoewel Varnish ook door W3 Total Cache ondersteund wordt is de plugin er<br />niet optimaal op afgestemd. Zo zijn er diverse aspecten waarmee de<br />plugin geen rekening mee houd.

=== Hiërarchische wijzigingen ===

Op veel websites wordt er gebruik gemaakt van een kruimelpad. Indien men<br />de titel of belangrijker, de url,  van een pagina wijzigt dient men niet<br />alleen de desbetreffende pagina cache te wijzigen maar ook de cache van<br />alle onderliggende pagina’s. Deze cache dient geleegd te worden om<br />foutieve links op de onderliggende pagina’s te voorkomen.

=== URL wijzigingen ===

In sommige gevallen is het gewenst om de url van een pagina te wijzigen.<br />Indien dit voor komt is het belangrijk dat de cache van de ‘oude’ pagina<br />geleegd wordt opdat deze niet langer bereikbaar is. W3 Total Cache leegt<br />enkel de cache van de ‘nieuwe’ pagina, het gevolg hiervan is dat er op<br />dat moment twee versies van de pagina bestaan; dit uiteraard ten nadelen<br />van de SEO op de website. Denk hierbij aan de [http://orangevalley.nl/google-panda-update-in-nederland/ Google Panda update] die<br />dubbele content op de website bestraft.

=== Menu wijzigingen ===

In WordPress kan men direct pagina’s en categorieën invoegen in het<br />menu. Bij het wijzigen van bijvoorbeeld een pagina titel of URL wordt<br />dan automatisch het menu bijgewerkt. W3 Total Cache erkent deze relaties<br />niet, na dergelijke wijzigingen wordt enkel de pagina cache geleegd; dit<br />terwijl in dit geval juist de algehele cache geleegd dient te worden.

= Varnish HTTP Purge =

Een ander veelgebruikte plugin naast W3 Total Cache is de Varnish HTTP<br />Purge plugin. In tegenstelling tot W3 Total Cache beperkt deze plugin<br />zich enkel tot een caching laag met betrekking tot Varnish.

Net als onze maatgemaakte oplossing fungeert de HTTP Purge plugin zich<br />als een communicatie laag tussen de website en Varnish. De plugin<br />monitort specifieke acties welke in de backend plaats vinden en flushed<br />vervolgens de bijhorende Varnish cache.

De HTTP purge plugin is echter een zeer beperkte plugin welke zich in<br />een beperkte mate richt op het legen van de cache rondom berichten. De<br />plugin beperkt zich enkel tot de basale relaties welke plaats vinden in<br />een basis WordPress installatie. Indien er gebruik gemaakt wordt van<br />eigen taxonomieën, auteur pagina’s of een aangepaste SEO structuur dan<br />schiet de HTTP Purge plugin al snel tekort.

Deze plugin is gericht op beheerders welke zich ervan bewust zijn<br />wanneer zij zelf de cache dienen te legen. Deze beheerders dienen de<br />relatie te begrijpen van de wijzigingen welke zij maken en de scoping<br />van de pagina’s welke de cache leegt na het uitvoeren van specifieke<br />acties.

= Incompatible plugins =

* GuiForm: Voegt een no-cache header toe aan iedere pagina.

